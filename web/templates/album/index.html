{% extends "base.html" %}

{% block title %}Album Manager - PixelGroomer{% endblock %}

{% block content %}
<div class="album-manager">
  <div class="flex justify-between items-center mb-4">
    <h1>Album Manager</h1>
  </div>
  
  <!-- Library Path Selection -->
  <div class="card mb-4">
    <div class="card-body">
      <form action="{{ url_for('album.set_library') }}" method="post">
        <label class="form-label" for="library-path">
          Photo Library
          {% if library_path != default_library_path %}
          <span class="text-subdued text-small">(custom)</span>
          {% endif %}
        </label>
        <div class="flex gap-2">
          <div class="path-picker" style="flex: 1;">
            <input type="text" 
                   class="form-input path-picker-input"
                   id="library-path"
                   name="library_path"
                   value="{{ library_path }}"
                   placeholder="{{ default_library_path }}">
            <button type="button" 
                    class="btn btn-secondary path-picker-btn"
                    onclick="openPathPicker('library-path', 'directory')">
              Browse
            </button>
          </div>
          <button type="submit" class="btn btn-secondary">Load</button>
          {% if library_path != default_library_path %}
          <button type="button"
                  class="btn btn-secondary"
                  onclick="document.getElementById('library-path').value='{{ default_library_path }}'; this.closest('form').submit();">
            Reset
          </button>
          {% endif %}
        </div>
      </form>
    </div>
  </div>
  
  <!-- Folder Selection -->
  <div class="card mb-4">
    <div class="card-body">
      <div class="flex gap-4 items-center">
        <div class="form-group" style="margin-bottom: 0; flex: 1;">
          <label class="form-label" for="folder-select">Folder</label>
          <select class="form-select" 
                  id="folder-select"
                  hx-get="{{ url_for('album.browser') }}"
                  hx-target="#image-browser"
                  hx-swap="innerHTML"
                  hx-include="this"
                  name="folder">
            <option value="">-- Select folder --</option>
            {% for folder in folders %}
            <option value="{{ folder }}" {% if folder == current_folder %}selected{% endif %}>
              {{ folder }}
            </option>
            {% endfor %}
          </select>
        </div>
        <div class="text-subdued text-small">
          {% if photos %}{{ photos|length }} photos{% endif %}
        </div>
      </div>
    </div>
  </div>
  
  <!-- Image Browser -->
  <div id="image-browser">
    {% include "album/browser.html" %}
  </div>
</div>
{% endblock %}
